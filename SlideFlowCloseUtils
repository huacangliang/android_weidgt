package com.aduer.lblcus.utils;

import android.app.Activity;
import android.support.v4.view.MotionEventCompat;
import android.view.MotionEvent;

/**
 * Created by looshort on 16/10/24.
 * emal:836673942@qq.com
 */

public class SlideFlowCloseUtils {
    int startX;
    int endX;
    int closeWidth;
    private listener listenr;

    public static SlideFlowCloseUtils startListener(final listener listener) {
        if (listener == null) return null;
        SlideFlowCloseUtils utils = new SlideFlowCloseUtils();
        utils.listenr = listener;
        return utils;
    }

    public boolean onTouch(Activity activity, MotionEvent event) {

        if (closeWidth == 0) {
            closeWidth = activity.getWindow().getDecorView().getWidth() / 5;
        }
        int index = event.getPointerCount();
        if (index > 1) return false;
        int action = MotionEventCompat.getActionMasked(event);
        switch (action) {
            case MotionEvent.ACTION_DOWN:
                startX = (int) event.getX();
                endX = 0;
                break;
            case MotionEvent.ACTION_MOVE:
                endX = (int) event.getX();
                break;
            case MotionEvent.ACTION_UP:
                if (startX < endX && endX - startX >= closeWidth) {
                    startX = 0;
                    endX = 0;
                    return listenr.closeActivity();
                }
                break;
        }
        return false;
    }

    public interface listener {
        boolean closeActivity();
    }
}
